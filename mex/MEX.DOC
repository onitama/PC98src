//
//					Midi Exclusive Manager / MEX.EXE
//					onion software 1993,94(c)
//

・MEXって…??

	MIDIのエクスクルーシブメッセージ（各楽器固有の特殊なデータ）
	をPC98上で管理するためのツールです。
	エクスクルーシブデータをファイルにセーブ、またファイルからデータを
	MIDIに出力する機能のほか、他のツールへのファイル変換、98などの
	FM音源データ（OPN音色）をYAMAHA FM音源エクスクルーシブに変換する
	機能などを持っています。



・動作環境

        PC9801ｼﾘｰｽﾞおよび、その互換機のMS-DOS上で動作します。
        MPU PC-98互換のMIDI I/Fに対応しています。


・基本的な使いかた

	> MEX ファイル名 [return]

	で、ファイルの内容をMIDIに出力します。
	拡張子が省略されているか、またはMEXの場合は、ファイルをMIDIバイナリ
	データとしてロードします。
	拡張子がMETの場合は、ファイルをテキスト化されたMIDIデータとして
	ロードします。

	> MEX /R /Sファイル名 [return]

	で、MIDIから送られてくるエクスクルーシブメッセージをファイルに
	セーブするモードになります。
	このモードでは、エクスクルーシブメッセージ以外は無視します。
	エクスクルーシブメッセージを受け終わった後、何も送られてこないと
	自動的に終了します。
	また、受信のモードを中止する時は、[ESC]を押して下さい。
	ファイル名を省略した場合は"MIDIEX"というファイルにセーブされます。
	METファイル（テキスト化されたMIDIデータ）でセーブする場合は、
	「MEX /R /Tファイル名」のように /S のかわりに /T を指定します。


・ちょっと便利なオプション

	/N数値

	METファイル（テキスト化されたMIDIデータ）内にある特定の番号の
	エクスクルーシブメッセージだけを送信したい時に指定します。

	/O

	拡張子がMETのファイル（テキスト化されたMIDIデータ）の内容のみを
	表示します。データの送信はされません。

	/E

	/R と同じくMIDIから送られてくるデータをファイルにセーブするモード
	になりますが、エクスクルーシブ受信後に自動的に終了することが
	なくなります。終了する場合は、[ESC]を押して下さい。

	/W数値

	データを受ける楽器の速度が追いつかない時に、出力するスピードを
	調節することができます。/W数値 で値が大きいほど遅いスピードに
	なります。/Wの指定がない時は、2に設定されています。


・特殊なオプション

	/Aファイル名

	Annex MIDI用のテキストファイルとしてデータを出力します。
	ファイル名が省略された場合は、MIDIEX.ANX になります。

	/C

	テキストファイルの出力をコンソールに変更します。
	画面に表示して確認したい時などに使用します。

	/Gグループ名

	OPNデータ変換時において、音色名を「グループ名＋音色番号」に
	します。

	/V数値

	OPNデータ変換時において、KVS（キーボードベロシティ）の係数を
	指定します。省略時は2になっています。


・METファイルについて

	METファイルは、MIDIエクスクルーシブのデータをテキストで記述
	したものです。MEX独自のもので次のようなフォーマットになって
	います。

	#番号 : {
		データ [ , データ , データ , .... ]
	}

	#の後にデータ番号（番号で呼びだす時に使用します）を入れて、
	: { で始まり、} で終わるまでの間に、,（カンマ）で区切られた
	データ列をMIDIデータとして扱います。それ以外の文字列は無視
	します。エラーにはなりません。

	データは$を頭につけると、16進数、何もつけないと10進数。
	'A'のようにすると、アスキーコードの1バイトデータになります。
	%"文字列" で、文字列のアスキーコードがそのままデータになります。
	また、%ss はチェックサムのデータを意味します。
	その際は、チェックサムの始まりに、*sum start を書いておく必要
	があります。
	;（セミコロン）以降はコメントとして読み飛ばします。
	"文字列"にコメントを入れると、データ送信時に表示されます。


・OPN音色変換機能について

	MEXでは、PC98,PC88などで使われているOPN（YM2203）の音色データを
	YAMAHAのFM音源マシン用エクスクルーシブ（VCED）に変換する機能が
	あります。そのためのデータは、METファイルとして次のようなフォー
	マットで書いておいて下さい。

	# @番号 : {
		FB , AL
		AR , DR , SR , RR , SL , OL , KS , ML , DT	; op.1
		AR , DR , SR , RR , SL , OL , KS , ML , DT	; op.2
		AR , DR , SR , RR , SL , OL , KS , ML , DT	; op.3
		AR , DR , SR , RR , SL , OL , KS , ML , DT	; op.4
		"音色名"
	}

	このようにして書かれたファイルを読みこむと自動的に、YAMAHAの
	エクスクルーシブに変換されて送信されます。
	このフォーマットは、MUSIC LALFのFM音色データテキストと互換性
	があるので、MUSIC LALFをお持ちの方は、その音色データをすぐに
	送ることができます。

	たくさんの音色をMETファイルにまとめて入れておいて、
	MEX /N音色番号 ファイル名.MET  などとして、番号で呼びだすと
	便利です。


・最後に

	自分で使うために作りはじめたものなので、不親切です(^^;)
	まだヨワヨワです(^^)　もっと便利にせんとなぁ・・。
	ご意見、質問、希望などあれば下のIDまで(^^)
	ネットへの転載はご自由にどうぞ。ただし改変はしないでね。

							おにたま

				e-mail  : 東京BBS        ( ONITAMA )
					  セタネット     ( SCL70556 )
					  Synergy BBS    ( ONITAMA )
					  Troubadour NET ( ONITAMA )

/*---------------------------------------------------------------------------
	ＧＩＮＴヘルプドキュメント
	pc98 graphic interface "gint.h" / 1992(c)onion software/Ana./XKD lab.
	'gint.h' , 'gint.obj' , 'pal.obj' , 'aska.obj' , 'font.obj'
---------------------------------------------------------------------------*/

	"GINT" ('gint.obj','pal.obj','aska.obj','font.obj') は、PC9801用の
	基本的なグラフィック機能をサポートするturboＣ(++)用の制御関数群です。
	GINTを使用する場合は、

		#include <stdio.h>
		#include <fcntl.h>
		#include <dos.h>
		#include "gint.h"		; use graphics interface
		#include "gint.inc"

	のファイルを最初にインクルードしておく必要があります。
	必ずスモールモデルでコンパイルして下さい。
	"gint.h"を使う場合は、4つのオブジェクトファイルもリンクします。

	例:（コマンドラインから）
		tcc -ms test.c font.obj gint.obj pal.obj aska.obj


	/*-------------------------------------------------------------------
		introduction
	-------------------------------------------------------------------*/

	GINTはPC98のグラフィック画面を使用したアプリケーションをＣ言語で作る
	のに適したモジュールで、次のような機能があります。

		◎高速で簡単なグラフィック操作
		◎通常の漢字メッセージに加え、強調文字や斜体、オリジナルの
		　フォント（３書体）の表示
		◎640x400dot 16色（ASKA形式）と、640x200dot 8色（PD4形式）の
		　グラフィックを展開
		◎GDCを使用したグラフィック画面の上下スクロール
		◎V-Syncを使用したアナログパレットの自動制御
		◎MS-DOSからのバイナリファイル読み込み，書き込み

	以下のモジュールをGINTと合わせて使用することで、さらに強力な
	アプリケーションを作成することができます。詳細は、それぞれの
	ドキュメントファイルを参照して下さい。

		・GMAP.H	キャラクタを使ったマップ表示，擬似スプライト
		・GPOL.H	ポリゴンを使用した３Ｄ表示
		・MGL.H		MAG形式のグラフィックを展開
		・PLAY.H	FM音源（2203）による音楽演奏
		・EMIOB.H	ファイル管理システム，オリジナルDOS

	機能を限定してコンパクトにした"MGINT"も用途に合わせてご利用下さい。


	/*-------------------------------------------------------------------
		command reference of "gint.h"
	-------------------------------------------------------------------*/

	◎グラフィック画面初期化
		ginit( int Lines,int SPage,int Sswitch );

		Lines	= 0(200line) , 1(400line)
		SPage	= 0(page0) , 1(page1)
		Sswitch	= 0(screen off) , 1(screen on)

	　グラフィックのスクリーンモードを指定して初期化を行ないます。
	　最初に必ずこの関数を使ってグラフィック画面を初期化して下さい。
	　VRAM,TEXT,パレットの内容は変化しません。
	　アナログ16色モードに自動的にセットされます。
	　以下の項目をチェックして、値がセットされます。

	　char	_board16_set	16色ボードがあるか（0=ない,1=ある）
	　char	_gdc_clock	GDCのクロック（0=2.5Mhz,1=5Mhz）
	　char	_gc_set		GRCGがあるか（0=ない,1〜=ある）
	　char	_egc_set	EGCがあるか（0=ない,1=ある）

	　16色ボードがない場合は、"gint.h"の関数群は使えないので、
	　チェックして終了させるようにして下さい。


	◎グラフィック画面クリア
		gcls( int Color );

		Color	= 0-15 (palette code)

	　グラフィック画面を指定した色でクリアします。
	　画面モードやTEXT VRAMの内容は変化しません。


	◎テキスト画面関係
		t_cls();   t_off();   t_on();

	　t_cls でテキスト画面をクリアします。
	　t_off,t_on はテキスト画面の一時的なON/OFFを行ないます。
	　内容は変化しませんが、終了時に t_on していないとDOS画面が
	　見えなくなるので注意が必要です。


	◎グラフィック画面漢字PUT
		kprt( int X,int Y,int Color,char *st );

		X	= 0-639 (X-axis)
		Y	= 0-399 (Y-axis)
		Color	= 0-15 (palette code) ( bit4=1 : 太い文字で出力 )
					      ( bit5=1 : 斜体文字/1 )
					      ( bit6=1 : 斜体文字/2 )
		*st	= 出力する文字列 (ptr.)

	　グラフィック画面の指定した座標から、漢字を含めた文字列を出力します。
	　画面の右端に行っても改行しませんので、１行が画面に収まる量を指定して
	　下さい。文字列はMS-DOSで使用しているシフトJISフォーマットのものを
	　そのまま使用できます。半角が含まれている場合は、オリジナルのフォント
	　で出力されます。CR+LFやBSなどのコントロールコードは認識されません。
	　ただし、TABコードは一応サポートしています（8カラムごと）。
	　カラーコードに16をORすると、漢字が１ドット横に太くされて読みやすく
	　なります。また、カラーコードに32もしくは、64をORすると斜体文字表示と
	　なります。32の場合は軽くそった書体、64だと激しく傾いた書体になります。


	◎オリジナルフォント画面PUT
		gprt( int X,int Y,int Color,char *st );

		X	= 0-79  (X-axis/8dot)
		Y	= 0-399 (Y-axis)
		Color	= 0-15 (palette code)
		*st	= 出力する文字列 (ptr.)

	　3タイプのオリジナルフォントを表示します。パラメータの指定は
	　kprt とほぼ同じです。ただし表示できるものは英文字のみです。
	　文字列で特別なコードとして、フォント切り替えの指定ができます。
	　"*0A HAPPY NEW YEAR" や "*1A HAPPY *2NEW YEAR" のように、"*n"
	　でフォントのバンクが切り替わります。
	　フォントのバンクによっては、パレット指定が無効なものがあります。


	◎グラフィック画面ボックスフィル
		GraphicBoxf( int X1,int Y1,int X2,int Y2,int Color );

		X1	= 0-639 (左上 X-axis)
		Y1	= 0-399 (左上 Y-axis)
		X2	= 0-639 (右下 X-axis)
		Y2	= 0-399 (右下 Y-axis)
		Color	= 0-15 (palette code)

	　指定したグラフィック画面の領域内を塗りつぶします。


	◎漢字１文字PUT
		KanjiGputc( int KANJI,int X,int Y,int Color );

		X	= 0-639 (X-axis)
		Y	= 0-399 (Y-axis)
		Color	= 0-15 (palette code) ( bit4=1 : 太い文字で出力 )
		KANJI	= 出力する漢字コード (シフトJIS)

	　グラフィック画面の指定した座標から、指定したコードの漢字１文字を
	　出力します。


	◎横ドット２倍変換
		hdbl();

	　グラフィック画面の左半分(0,0)-(319,399)を横２倍に変換します。
	　見かけ上320x200の表示をするために使います。


	◎GDCグラフィック画面スムーズスクロール
		gscroll( int sc_dir,int sc_len,int sc_step );

		sc_dir	= 0(上) , 1(下)
		sc_len	= 1-400 (lines)
		sc_step = 1-4 (lines)

	　グラフィック画面のスムーズスクロールを行ないます。
	　sc_dirで指定した方向に、sc_lenで指定したライン数だけスクロール
	　します。sc_stepは１度にスクロールするライン数です。通常は１ですが、
	　スクロールのスピードが遅い時などは増やすとよいでしょう。
	　スクロールする前の画面は必ずページ０に、スクロールして出てくる
	　画面の情報は必ずページ１に置いておかなければなりません。
	　この関数実行後は、VRAMのアドレスが狂ってしまうので、一度 ginit で
	　初期化し直して下さい。
	　主に、800ラインの絵をスクロール表示するための関数です。


	◎グラフィック画面ページ切り替え
		set_page( int apage, int dpage );

		apage	= 0(page0) , 1(page1)
		dpage	= 0(page0) , 1(page1)

	　グラフィック画面のページ切り替えを行ないます。
	　apageは描画を行なうページ（アクティブページ），
	　dpageは画面に表示させておくページ（ディスプレイページ）です。


	◎PD4形式グラフィック展開
		xkd_pic( char X,char Y,char *st );

		X	= 0-79  (X-axis/8)
		Y	= 0-199 (Y-axis/2)
		*st	= 圧縮データのポインタ

	　主にPC8801で使われていた200ライン8色グラフィック圧縮フォーマット
	　PD4を展開します。400ラインモードの画面にパレットコード0-7で展開
	　されます。使用する機会のほとんどない、おまけ機能です。


	◎キー入力バッファクリア
		int jinit();

	　リアルタイムキー入力などで溜まったキーバッファをクリアします。
	　DOSに戻る直前に実行すると、戻ってから勝手に文字が入力されることが
	　なくなります。


	◎ゲーム・アプリケーション用キー入力
		int joyin();

	　ゲームなどに必要なテンキーのキー入力情報、ジョイスティックからの
	　入力情報を調べます。返り値はintで内容は以下の通りです。

		bit0 (  1) = テンキーの[2]，ジョイスティック下
		bit1 (  2) = テンキーの[8]，ジョイスティック上
		bit2 (  4) = テンキーの[4]，ジョイスティック左
		bit3 (  8) = テンキーの[6]，ジョイスティック右
		bit4 ( 16) = スペースキー
		bit5 ( 32) = [ESC]キー
		bit6 ( 64) = [X]キーまたはジョイスティックＡボタン
		bit7 (128) = [Z]キーまたはジョイスティックＢボタン


	◎リアルタイムキー入力
		int kinp( int matrix );

		matrix	= 0-15 ( key board matrix )

	　キーボードのリアルタイムキー入力情報をintで返します。
	　キーボードマトリックス番号と、各ビットの内容はPC98の
	　テクニカルマニュアルなどを参照して下さい。


	◎パレットルーチン初期化
		pal_init();

	　パレットに関する関数を使用する前に必ず実行して下さい。
	　パレットルーチン初期化を実行しても、パレットの内容は変化しません。
	　パレットルーチン初期化をすると、V-Sync割り込みをパレットルーチン側が
	　管理するようになります。
	　パレットルーチンの使用を終えて、DOSや他のアプリケーションに戻る
	　時には必ず pal_done() でV-Syncをもとの状態に戻して下さい。


	◎パレットルーチン終了
		pal_done();

	　パレットルーチンの使用を終えた時に実行します。
	　パレットルーチン側が管理していたV-Sync割り込みを、もとの状態に
	　戻します。


	◎パレットセット
		pal_set( int Pal , int Code );

		Pal	= 0-15 (palette code)
		Code	= 0-4095 (color code)

	　指定したパレットコードにカラーを割り当てます。
	　この関数を実行した時点では、パレットは変わりません。
	　pal_shop,pal_fade などの命令を実行してはじめて、
	　パレット全体が一度に変化します。


	◎パレット変更
		pal_show( int Grade );

		Grade	= 0-16 (bright)

	　パレット全体をpal_setで指定した内容に変更します。
	　Gradeで指定した輝度に瞬時に変更されます。
	　輝度は、0が完全に見えない状態、16がpal_setで指定した
	　状態と同じになります。


	◎パレットフェード
		pal_fade( int Speed );

		Speed	= -127〜+127
			  ( -1〜-127 : fadeout )
			  ( +1〜+127 : fadein  )

	　パレット全体をフェードイン、もしくはフェードアウトします。
	　Speedの値がマイナスならフェードアウト、正の値ならフェードイン
	　を行ないます。
	　パレットフェードは、現在の輝度からフェードイン・フェードアウトが
	　開始されるので、フェードインを行なう時はあらかじめ暗い輝度に、
	　フェードアウトを行なう時は、あらかじめ明るい輝度に設定されている
	　必要があります。
	　フェードイン・アウトのスピードは、0に近いほど速くなります。
	　フェードイン・アウトはV-Sync割り込みで行ないますので、その処理中
	　であっても、他の処理をすることができます。


	◎パレットフェード待ち
		pal_wait();

	　パレットフェードが完了するまで待ちます。
	　pal_fade でパレットのフェードイン・アウトを実行させると、
	　フェード中であっても次の動作に進んでしまいますが、
	　pal_fade の後に pal_wait を入れておくと、フェードが完了するまで
	　次の動作に進みません。


	◎V-Syncを使ったウエイト
		vwait( int Speed );

		Speed	= 1〜65535 (V-Sync times)

	　Speedの値だけウエイト（待ち）を入れます。
	　このウエイトは、以前に vwait が実行されてからの時間なので、
	　リアルタイムゲームなどで、メインループ内の時間を一定にする場合
	　に使うことができます。

		例：	while (flag==0) {
				playermove()
				enemymove()
				drawscreen()
				vwait(6)	/* 全体の流れを一定のSPEEDに */
				}

	　この関数は、パレット操作とは直接関係ありませんが、
	　pal_init でV-Sync割り込みを管理している状態でないと使用する
	　ことができませんので注意して下さい。


	◎ASKA形式グラフィック展開
		ask_pic( char *fname , int buff , int vofs )

		*fname	= ファイル名（文字列PTR.）
		buff	= データバッファのセグメントアドレス
		vofs	= 表示位置のオフセット（0〜65535/通常は0）

	　ASKA形式のグラフィック（MAX 640x400,16color XKD laboratory製）の
	　データを展開します。
	　ファイル名とバッファになるメモリのセグメントアドレスをパラメータで
	　渡す必要があります。セグメントアドレスは、あらかじめ allocmem で
	　領域を確保しておいた値になります。（メモリ確保は malloc ではなく、
	　allocmem で行なって下さい）
	　ファイルを読み込むと、画面にグラフィックが展開され、アナログパレット
	　の情報が、pal_setによってセットされます。
	　展開される座標，大きさ，重ね合わせの情報などはすべてASKA.COMで
	　セーブする際に指定して下さい。
	　ただし、vofsを変更することで、座標（0,0）の位置をVRAMのバイト単位で
	　変えることができます。


	◎バイナリファイル読み込み
		seg_load( char *fname, int load_seg , int load_size )

		*fname	  = ファイル名（文字列PTR.）
		load_seg  = 読み込むバッファのセグメントアドレス
		load_size = 読み込むサイズ（byte）

		返り値	  : 	0  正常終了
				1  エラー（指定したファイルが存在しない）

	　バイナリファイルを指定したセグメントアドレスから読み込みます。
	　バッファはあらかじめ、allocmemで確保しておいて下さい。


	◎バイナリファイル書き出し
		seg_save( char *fname, int save_seg , int save_size )

		*fname	  = ファイル名（文字列PTR.）
		save_seg  = 書き出すバッファのセグメントアドレス
		save_size = 書き込むサイズ（byte）

		返り値	  : 	0  正常終了
				1  エラー（何らかの理由で書き込みができない）

	　指定したセグメントアドレスからのデータをバイナリファイルに
	　書き出します。
	　バッファはあらかじめ、allocmemで確保しておいて下さい。


	/*-------------------------------------------------------------------
		copyright
	-------------------------------------------------------------------*/


	'gint.h','gint.obj','font.obj'	(c)1992 onion software ( expect *,** )
	'pal.obj'			(c)1992 T.Anazawa
	'aska.obj',*xkd_pic,**gscroll	(c)1992 XKD laboratory
	*xkd_pic			(c)1992 usuaji


/*---------------------------------------------------------------------------
	pc98 graphic interface "gint.h" / 1992(c)onion software/Ana./XKD lab.
	Brief information of 'gint.obj' , 'pal.obj' , 'aska.obj' , 'font.obj'
---------------------------------------------------------------------------*/

